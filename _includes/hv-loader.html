{% comment %} Load HTML files into an Iframe {% endcomment %}

<script>
  window.onmessage = (e) => {

  if (e.data.hasOwnProperty("frameHeight")) {

    document.getElementById("_iframe").style.height = `${e.data.frameHeight + 30}px`;

  }

};
</script>

<script type="text/javascript">
  {% for chart in page.hv-loader %}
    document.addEventListener("DOMContentLoaded",function(){
      let el = document.getElementById("{{ chart[0] }}")
      if (el===null)
        alert("Error: cannot embed HTML chart because the div element with id '{{ chart[0] }}' does not exist.")
      let spec = "{{ site.baseurl }}/{{ chart[1] }}";
      el.innerHTML = `<iframe width="100%" scrolling="no" frameborder="0" id="_iframe" src="${spec}">
        <script>
          setInterval(function() {
    // first parameter is the message to be passed
    // second paramter is the domain of the parent 
    // in this case "*" has been used for demo sake (denoting no preference)
    // in production always pass the target domain for which the message is intended 
            window.top.postMessage(document.body.scrollHeight, "*");
          }, 500); 
        </script>
      </iframe>`;
    });
  {% endfor %}
</script>
